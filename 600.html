<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ø¹Ù„ÙˆÙ… - Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            margin: 0;
            padding: 0;
            background-color: #f5f9ff;
            color: #333;
            line-height: 1.6;
            font-size: 14px;
        }
        
        .container {
            max-width: 100%;
            padding: 10px;
        }
        
        .header {
            text-align: center;
            background: linear-gradient(to right, #e74c3c, #e67e22);
            color: white;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            margin: 5px 0;
            font-size: 18px;
        }
        
        .header h2 {
            margin: 5px 0;
            font-size: 16px;
        }
        
        .code-entry {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 15px;
            text-align: center;
        }
        
        .code-input {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 6px;
            margin: 10px 0;
            direction: ltr;
        }
        
        .code-input:focus {
            border-color: #e74c3c;
            outline: none;
        }
        
        .btn {
            background-color: #e67e22;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            font-size: 15px;
            cursor: pointer;
            transition: background-color 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn:hover {
            background-color: #d35400;
        }
        
        .btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .exam-container {
            display: none;
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 15px;
        }
        
        .question {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #eee;
        }
        
        .question-number {
            background-color: #e74c3c;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-left: 8px;
            font-weight: bold;
        }
        
        .question-text {
            font-weight: bold;
            margin: 10px 0;
            font-size: 15px;
        }
        
        .section-title {
            background-color: #fef9e7;
            padding: 10px;
            border-radius: 6px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
            color: #e74c3c;
            border-right: 4px solid #e67e22;
        }
        
        .mcq-options {
            margin-top: 10px;
        }
        
        .mcq-option {
            margin-bottom: 8px;
            padding: 10px;
            border-radius: 6px;
            background-color: #f9f9f9;
            cursor: pointer;
            transition: background-color 0.2s;
            border: 1px solid #eee;
        }
        
        .mcq-option:hover {
            background-color: #f0f0f0;
        }
        
        .mcq-option.selected {
            background-color: #fdebd0;
            border-right: 4px solid #e67e22;
        }
        
        .mcq-label {
            display: inline-block;
            width: 25px;
            height: 25px;
            background-color: #e74c3c;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 25px;
            margin-left: 8px;
            font-weight: bold;
        }
        
        .true-false-options {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .true-false-btn {
            flex: 1;
            padding: 10px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            background-color: white;
            font-size: 16px;
        }
        
        .true-false-btn.selected {
            font-weight: bold;
        }
        
        .true-false-btn.true.selected {
            background-color: #d4edda;
            border-color: #28a745;
            color: #155724;
        }
        
        .true-false-btn.false.selected {
            background-color: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }
        
        .results-container {
            display: none;
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 15px;
        }
        
        .results-header {
            text-align: center;
            background-color: #e74c3c;
            color: white;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .score {
            font-size: 24px;
            font-weight: bold;
            color: #e67e22;
            text-align: center;
            margin: 15px 0;
        }
        
        .mistakes-list {
            margin-top: 20px;
        }
        
        .mistake-item {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 6px;
            background-color: #f8f9fa;
            border-right: 4px solid #dc3545;
        }
        
        .correct-answer {
            color: #28a745;
            font-weight: bold;
        }
        
        .user-answer {
            color: #dc3545;
            font-weight: bold;
        }
        
        .message {
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }
        
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border-right: 4px solid #dc3545;
        }
        
        .success {
            background-color: #d4edda;
            color: #155724;
            border-right: 4px solid #28a745;
        }
        
        .warning {
            background-color: #fff3cd;
            color: #856404;
            border-right: 4px solid #ffc107;
        }
        
        .timer {
            text-align: center;
            font-weight: bold;
            color: #e74c3c;
            margin: 10px 0;
            padding: 8px;
            background-color: #fef9e7;
            border-radius: 6px;
        }
        
        .footer {
            text-align: center;
            margin-top: 20px;
            padding: 10px;
            color: #666;
            font-size: 12px;
            border-top: 1px solid #eee;
        }
        
        @media (min-width: 768px) {
            body {
                font-size: 15px;
            }
            
            .container {
                max-width: 600px;
                margin: 0 auto;
            }
            
            .btn {
                width: auto;
            }
            
            .code-input {
                width: 80%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ø®Ø§ØµØ©</h1>
            <h2>Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ø¹Ù„ÙˆÙ… Ù„Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</h2>
            <div class="timer" id="timeDisplay"></div>
        </div>
        
        <div class="code-entry" id="codeEntry">
            <h3>Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</h3>
            <input type="text" id="studentCode" class="code-input" placeholder="Ø£Ø¯Ø®Ù„ 9 Ø£Ø±Ù‚Ø§Ù…" maxlength="9" inputmode="numeric">
            <button id="startExamBtn" class="btn">Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</button>
            <div id="codeMessage" class="message"></div>
        </div>
        
        <div class="exam-container" id="examContainer">
            <div class="section-title">Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:</div>
            
            <div class="question">
                <div><span class="question-number">1</span> <span class="question-text">Ù…Ù† Ø·Ø±Ù‚ Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ø­Ø±Ø§Ø±Ø© ........</span></div>
                <div class="mcq-options">
                    <div class="mcq-option" data-question="1" data-option="Ø§Ù„Ø­Ù…Ù„"><span class="mcq-label">Ø£</span> Ø§Ù„Ø­Ù…Ù„</div>
                    <div class="mcq-option" data-question="1" data-option="Ø§Ù„ØªÙˆØµÙŠÙ„"><span class="mcq-label">Ø¨</span> Ø§Ù„ØªÙˆØµÙŠÙ„</div>
                    <div class="mcq-option" data-question="1" data-option="Ø§Ù„Ø¥Ø´Ø¹Ø§Ø¹"><span class="mcq-label">Ø¬</span> Ø§Ù„Ø¥Ø´Ø¹Ø§Ø¹</div>
                    <div class="mcq-option" data-question="1" data-option="Ø¬Ù…ÙŠØ¹ Ù…Ø§ Ø³Ø¨Ù‚"><span class="mcq-label">Ø¯</span> Ø¬Ù…ÙŠØ¹ Ù…Ø§ Ø³Ø¨Ù‚</div>
                </div>
            </div>
            
            <div class="question">
                <div><span class="question-number">2</span> <span class="question-text">Ø¹Ù†Ø¯Ù…Ø§ ØªÙ„Ù…Ø³ Ø¨ÙŠØ¯ÙŠÙƒ ÙƒÙˆØ¨Ù‹Ø§ Ù…Ø¹Ø¯Ù†ÙŠÙ‹Ø§ Ø³Ø§Ø®Ù†Ù‹Ø§ ÙØ¥Ù† Ø§Ù„Ø­Ø±Ø§Ø±Ø© ØªÙ†ØªÙ‚Ù„ Ø¥Ù„ÙŠÙƒ Ø¹Ù† Ø·Ø±ÙŠÙ‚ ........</span></div>
                <div class="mcq-options">
                    <div class="mcq-option" data-question="2" data-option="Ø§Ù„ØªÙˆØµÙŠÙ„"><span class="mcq-label">Ø£</span> Ø§Ù„ØªÙˆØµÙŠÙ„</div>
                    <div class="mcq-option" data-question="2" data-option="Ø§Ù„Ø­Ù…Ù„"><span class="mcq-label">Ø¨</span> Ø§Ù„Ø­Ù…Ù„</div>
                    <div class="mcq-option" data-question="2" data-option="Ø§Ù„Ø¥Ø´Ø¹Ø§Ø¹"><span class="mcq-label">Ø¬</span> Ø§Ù„Ø¥Ø´Ø¹Ø§Ø¹</div>
                    <div class="mcq-option" data-question="2" data-option="Ø§Ù„Ø­Ù…Ù„ ÙˆØ§Ù„Ø¥Ø´Ø¹Ø§Ø¹"><span class="mcq-label">Ø¯</span> Ø§Ù„Ø­Ù…Ù„ ÙˆØ§Ù„Ø¥Ø´Ø¹Ø§Ø¹</div>
                </div>
            </div>
            
            <div class="question">
                <div><span class="question-number">3</span> <span class="question-text">Ù…Ù† Ø§Ù„Ø¹ÙˆØ§Ù…Ù„ Ø§Ù„ØªÙŠ ÙŠØªÙˆÙ‚Ù Ø¹Ù„ÙŠÙ‡Ø§ Ø§Ù„Ø¹Ø²Ù„ Ø§Ù„Ø­Ø±Ø§Ø±ÙŠ ........ Ø§Ù„Ù…Ø§Ø¯Ø©.</span></div>
                <div class="mcq-options">
                    <div class="mcq-option" data-question="3" data-option="Ù†ÙˆØ¹"><span class="mcq-label">Ø£</span> Ù†ÙˆØ¹</div>
                    <div class="mcq-option" data-question="3" data-option="Ø´ÙƒÙ„"><span class="mcq-label">Ø¨</span> Ø´ÙƒÙ„</div>
                    <div class="mcq-option" data-question="3" data-option="Ù„ÙˆÙ†"><span class="mcq-label">Ø¬</span> Ù„ÙˆÙ†</div>
                    <div class="mcq-option" data-question="3" data-option="ÙƒØ«Ø§ÙØ©"><span class="mcq-label">Ø¯</span> ÙƒØ«Ø§ÙØ©</div>
                </div>
            </div>
            
            <div class="question">
                <div><span class="question-number">4</span> <span class="question-text">Ø¹Ù†Ø¯ Ø§Ù†ØµÙ‡Ø§Ø± Ù…ÙƒØ¹Ø¨ Ù…Ù† Ø§Ù„Ø«Ù„Ø¬ ÙƒØªÙ„ØªÙ‡ 10 Ø¬Ø±Ø§Ù…Ø§Øª ÙØ¥Ù† ÙƒØªÙ„Ø© Ø§Ù„Ù…Ø§Ø¡ Ø§Ù„Ø³Ø§Ø¦Ù„ ØªÙƒÙˆÙ† ........ Ø¬Ø±Ø§Ù…Ø§Øª.</span></div>
                <div class="mcq-options">
                    <div class="mcq-option" data-question="4" data-option="5"><span class="mcq-label">Ø£</span> 5</div>
                    <div class="mcq-option" data-question="4" data-option="9"><span class="mcq-label">Ø¨</span> 9</div>
                    <div class="mcq-option" data-question="4" data-option="10"><span class="mcq-label">Ø¬</span> 10</div>
                    <div class="mcq-option" data-question="4" data-option="12"><span class="mcq-label">Ø¯</span> 12</div>
                </div>
            </div>
            
            <div class="question">
                <div><span class="question-number">5</span> <span class="question-text">Ø¹Ù†Ø¯Ù…Ø§ ØªÙ„Ù…Ø³ Ø¬Ø³Ù…Ø§ Ø³Ø§Ø®Ù†Ø§ ØªÙ†ØªÙ‚Ù„ Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø¥Ù„Ù‰ Ø§ÙŠØ¯ÙŠÙƒ Ø¹Ù† Ø·Ø±ÙŠÙ‚</span></div>
                <div class="mcq-options">
                    <div class="mcq-option" data-question="5" data-option="Ø§Ù„ØªÙˆØµÙŠÙ„"><span class="mcq-label">Ø£</span> Ø§Ù„ØªÙˆØµÙŠÙ„</div>
                    <div class="mcq-option" data-question="5" data-option="Ø§Ù„Ø­Ù…Ù„"><span class="mcq-label">Ø¨</span> Ø§Ù„Ø­Ù…Ù„</div>
                    <div class="mcq-option" data-question="5" data-option="Ø§Ù„Ø¥Ø´Ø¹Ø§Ø¹"><span class="mcq-label">Ø¬</span> Ø§Ù„Ø¥Ø´Ø¹Ø§Ø¹</div>
                    <div class="mcq-option" data-question="5" data-option="Ø§Ù„Ø§Ø­ØªÙƒØ§Ùƒ"><span class="mcq-label">Ø¯</span> Ø§Ù„Ø§Ø­ØªÙƒØ§Ùƒ</div>
                </div>
            </div>
            
            <div class="section-title">Ø¶Ø¹ Ø¹Ù„Ø§Ù…Ø© (âœ“) Ø£Ùˆ Ø¹Ù„Ø§Ù…Ø© (âœ—) Ø£Ù…Ø§Ù… Ø§Ù„Ø¹Ø¨Ø§Ø±Ø§Øª Ø§Ù„Ø¢ØªÙŠØ©:</div>
            
            <div class="question">
                <div><span class="question-number">6</span> <span class="question-text">ØªØ¸Ù„ ÙƒØªÙ„Ø© Ø§Ù„Ù…Ø§Ø¯Ø© ÙƒÙ…Ø§ Ù‡ÙŠ Ø¹Ù†Ø¯ ØªØ­ÙˆÙ„Ù‡Ø§ Ù…Ù† Ø­Ø§Ù„Ø© Ø¥Ù„Ù‰ Ø£Ø®Ø±Ù‰.</span></div>
                <div class="true-false-options">
                    <div class="true-false-btn true" data-question="6" data-answer="true">âœ“</div>
                    <div class="true-false-btn false" data-question="6" data-answer="false">âœ—</div>
                </div>
            </div>
            
            <div class="question">
                <div><span class="question-number">7</span> <span class="question-text">ÙŠØ²Ø¯Ø§Ø¯ Ø§Ù„Ø¹Ø²Ù„ Ø§Ù„Ø­Ø±Ø§Ø±ÙŠ Ù„Ù„Ù…Ù‚Ø¨Ø¶ Ø¨Ø²ÙŠØ§Ø¯Ø© Ø·ÙˆÙ„Ù‡.</span></div>
                <div class="true-false-options">
                    <div class="true-false-btn true" data-question="7" data-answer="true">âœ“</div>
                    <div class="true-false-btn false" data-question="7" data-answer="false">âœ—</div>
                </div>
            </div>
            
            <div class="question">
                <div><span class="question-number">8</span> <span class="question-text">ØªÙ†ØªÙ‚Ù„ Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù…Ø¯ÙØ£Ø© Ø¥Ù„ÙŠÙ†Ø§ Ø¨Ø§Ù„Ø­Ù…Ù„ ÙˆØ§Ù„Ø¥Ø´Ø¹Ø§Ø¹.</span></div>
                <div class="true-false-options">
                    <div class="true-false-btn true" data-question="8" data-answer="true">âœ“</div>
                    <div class="true-false-btn false" data-question="8" data-answer="false">âœ—</div>
                </div>
            </div>
            
            <div class="question">
                <div><span class="question-number">9</span> <span class="question-text">Ø§Ù„Ù†Ø­Ø§Ø³ Ù…Ù† Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„ØªÙŠ ØªØ¨Ø·Ø¦ Ù…Ù† Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø®Ù„Ø§Ù„Ù‡Ø§.</span></div>
                <div class="true-false-options">
                    <div class="true-false-btn true" data-question="9" data-answer="true">âœ“</div>
                    <div class="true-false-btn false" data-question="9" data-answer="false">âœ—</div>
                </div>
            </div>
            
            <div class="question">
                <div><span class="question-number">10</span> <span class="question-text">Ø¹Ù†Ø¯ Ù„Ù…Ø³ Ø§Ù„Ø«Ù„Ø¬ Ù†Ø´Ø¹Ø± Ø¨Ø§Ù„Ø¨Ø±ÙˆØ¯Ø© Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ø¨Ø±ÙˆØ¯Ø© Ù…Ù† Ø§Ù„Ø«Ù„Ø¬ Ø¥Ù„Ù‰ Ø£ÙŠØ¯ÙŠÙ†Ø§.</span></div>
                <div class="true-false-options">
                    <div class="true-false-btn true" data-question="10" data-answer="true">âœ“</div>
                    <div class="true-false-btn false" data-question="10" data-answer="false">âœ—</div>
                </div>
            </div>
            
            <button id="submitExamBtn" class="btn">Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† ÙˆØªØµØ­ÙŠØ­ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª</button>
            <div id="examMessage" class="message"></div>
        </div>
        
        <div class="results-container" id="resultsContainer">
            <div class="results-header">
                <h2>Ù†ØªÙŠØ¬Ø© Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ø¹Ù„ÙˆÙ…</h2>
                <p>Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</p>
            </div>
            
            <div class="score" id="finalScore"></div>
            
            <div id="mistakesList" class="mistakes-list"></div>
            
            <button id="backToCodeBtn" class="btn">Ø¹ÙˆØ¯Ø© Ù„ØµÙØ­Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
        </div>
        
        <div class="footer">
            <p>Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ø®Ø§ØµØ© - Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</p>
        </div>
    </div>

    <script>
        // Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„ØµØ­ÙŠØ­Ø© Ù„Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³
        const correctAnswers = {
            1: "Ø¬Ù…ÙŠØ¹ Ù…Ø§ Ø³Ø¨Ù‚",
            2: "Ø§Ù„ØªÙˆØµÙŠÙ„",
            3: "Ù†ÙˆØ¹",
            4: "10",
            5: "Ø§Ù„ØªÙˆØµÙŠÙ„",
            6: true,   // âœ“
            7: true,   // âœ“
            8: true,   // âœ“
            9: false,  // âœ—
            10: false  // âœ—
        };
        
        // ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        let userAnswers = {};
        let studentCode = "";
        let deviceId = "";
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ø±Ù‘Ù ÙØ±ÙŠØ¯ Ù„Ù„Ø¬Ù‡Ø§Ø²
        function generateDeviceId() {
            const navigatorInfo = JSON.stringify({
                userAgent: navigator.userAgent,
                language: navigator.language,
                platform: navigator.platform
            });
            
            let hash = 0;
            for (let i = 0; i < navigatorInfo.length; i++) {
                const char = navigatorInfo.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            
            const randomToken = Math.random().toString(36).substring(2, 10);
            return `DEV${Math.abs(hash).toString(16).substring(0, 6).toUpperCase()}${randomToken}`;
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙØªØ§Ø­ ØªØ®Ø²ÙŠÙ† ÙØ±ÙŠØ¯ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†
        function getExamStorageKey(code) {
            const examId = "SCIENCE_EXAM_6TH_GRADE";
            return `EXAM_${btoa(code + "_" + examId).substring(0, 20)}`;
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙØªØ§Ø­ ØªØ®Ø²ÙŠÙ† ÙØ±ÙŠØ¯ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù‡Ø§ØªÙ
        function getPhoneStorageKey() {
            return `PHONE_CODE_${deviceId}`;
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¯Ø®Ù„
        function isValidCode(code) {
            return /^\d{9}$/.test(code);
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆÙ‚Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
        function isWithinAllowedTime() {
            const now = new Date();
            const currentHour = now.getHours();
            return currentHour < 24;
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø²
        function canTakeExam(code) {
            deviceId = localStorage.getItem("device_id") || generateDeviceId();
            localStorage.setItem("device_id", deviceId);
            
            const phoneKey = getPhoneStorageKey();
            const deviceCodes = JSON.parse(localStorage.getItem(phoneKey) || "[]");
            
            const existingCode = deviceCodes.find(item => item.code === code);
            if (existingCode) {
                return { allowed: false, reason: "Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù…Ù† Ù‚Ø¨Ù„" };
            }
            
            if (deviceCodes.length >= 2) {
                return { allowed: false, reason: "ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø²" };
            }
            
            if (!isWithinAllowedTime()) {
                return { allowed: false, reason: "Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† ØºÙŠØ± Ù…ØªØ§Ø­ Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø© 12 Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„" };
            }
            
            return { allowed: true };
        }
        
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù†Ø§Ø¬Ø­
        function registerExamAttempt(code) {
            deviceId = localStorage.getItem("device_id") || generateDeviceId();
            localStorage.setItem("device_id", deviceId);
            
            const phoneKey = getPhoneStorageKey();
            const deviceCodes = JSON.parse(localStorage.getItem(phoneKey) || "[]");
            
            const attemptId = `ATT${Date.now()}${Math.random().toString(36).substring(2, 7)}`;
            
            deviceCodes.push({
                code: code,
                attemptId: attemptId,
                timestamp: new Date().toISOString(),
                deviceSymbol: `ğŸ“±${deviceId.substring(3, 7)}`,
                codeSymbol: `ğŸ”¢${code.substring(0, 3)}`,
                uniqueToken: Math.random().toString(36).substring(2, 15)
            });
            
            localStorage.setItem(phoneKey, JSON.stringify(deviceCodes));
            
            const examKey = getExamStorageKey(code);
            const examRecord = {
                code: code,
                deviceId: deviceId,
                attemptId: attemptId,
                timestamp: new Date().toISOString(),
                completed: false,
                deviceSymbol: `ğŸ“±${deviceId.substring(3, 7)}`,
                codeSymbol: `ğŸ”¢${code.substring(0, 3)}`
            };
            localStorage.setItem(examKey, JSON.stringify(examRecord));
            
            const uniqueKey = `EXAM_${attemptId}`;
            const uniqueRecord = {
                examCode: code,
                deviceId: deviceId,
                timestamp: new Date().toISOString(),
                token: Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15),
                deviceMark: `ğŸ“±${deviceId.substring(3, 7)}`,
                codeMark: `ğŸ”¢${code.substring(3, 6)}`,
                securityHash: btoa(`${code}_${deviceId}_${Date.now()}`).substring(0, 20)
            };
            localStorage.setItem(uniqueKey, JSON.stringify(uniqueRecord));
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„Ø¹Ø±Ø¶
        function updateTimeDisplay() {
            const now = new Date();
            const timeDisplay = document.getElementById('timeDisplay');
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            timeDisplay.textContent = `Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ: ${hours}:${minutes}`;
            
            if (!isWithinAllowedTime()) {
                document.getElementById('startExamBtn').disabled = true;
                document.getElementById('studentCode').disabled = true;
                document.getElementById('codeMessage').textContent = "Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† ØºÙŠØ± Ù…ØªØ§Ø­ Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø© 12 Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„";
                document.getElementById('codeMessage').className = "message error";
            }
        }
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            updateTimeDisplay();
            setInterval(updateTimeDisplay, 60000);
            
            document.getElementById('startExamBtn').addEventListener('click', startExam);
            document.getElementById('submitExamBtn').addEventListener('click', submitExam);
            document.getElementById('backToCodeBtn').addEventListener('click', backToCodeEntry);
            
            document.getElementById('studentCode').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startExam();
                }
            });
            
            document.querySelectorAll('.mcq-option').forEach(option => {
                option.addEventListener('click', function() {
                    const questionNum = this.getAttribute('data-question');
                    const selectedOption = this.getAttribute('data-option');
                    
                    document.querySelectorAll(`.mcq-option[data-question="${questionNum}"]`).forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    this.classList.add('selected');
                    userAnswers[questionNum] = selectedOption;
                });
            });
            
            document.querySelectorAll('.true-false-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const questionNum = this.getAttribute('data-question');
                    const answer = this.getAttribute('data-answer') === 'true';
                    
                    document.querySelectorAll(`.true-false-btn[data-question="${questionNum}"]`).forEach(b => {
                        b.classList.remove('selected');
                    });
                    
                    this.classList.add('selected');
                    userAnswers[questionNum] = answer;
                });
            });
            
            const savedCode = sessionStorage.getItem('current_exam_code');
            if (savedCode) {
                studentCode = savedCode;
                showExam();
            }
        });
        
        // Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†
        function startExam() {
            const codeInput = document.getElementById('studentCode');
            const code = codeInput.value.trim();
            const messageDiv = document.getElementById('codeMessage');
            
            if (!isValidCode(code)) {
                messageDiv.textContent = "Ø§Ù„ÙƒÙˆØ¯ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªÙƒÙˆÙ† Ù…Ù† 9 Ø£Ø±Ù‚Ø§Ù… (Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙÙ‚Ø·)";
                messageDiv.className = "message error";
                return;
            }
            
            const checkResult = canTakeExam(code);
            if (!checkResult.allowed) {
                messageDiv.textContent = checkResult.reason;
                messageDiv.className = "message error";
                return;
            }
            
            registerExamAttempt(code);
            studentCode = code;
            
            sessionStorage.setItem('current_exam_code', code);
            showExam();
        }
        
        // Ø¹Ø±Ø¶ Ù‚Ø³Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†
        function showExam() {
            document.getElementById('codeEntry').style.display = 'none';
            document.getElementById('examContainer').style.display = 'block';
            document.getElementById('resultsContainer').style.display = 'none';
            
            userAnswers = {};
            document.querySelectorAll('.mcq-option.selected').forEach(opt => opt.classList.remove('selected'));
            document.querySelectorAll('.true-false-btn.selected').forEach(btn => btn.classList.remove('selected'));
            
            document.getElementById('examMessage').textContent = "";
            document.getElementById('examMessage').className = "message";
        }
        
        // ØªØµØ­ÙŠØ­ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†
        function submitExam() {
            const totalQuestions = Object.keys(correctAnswers).length;
            const answeredQuestions = Object.keys(userAnswers).length;
            
            if (answeredQuestions < totalQuestions) {
                document.getElementById('examMessage').textContent = `ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©. Ù„Ø¯ÙŠÙƒ ${answeredQuestions} Ù…Ù† Ø£ØµÙ„ ${totalQuestions} Ø¥Ø¬Ø§Ø¨Ø©.`;
                document.getElementById('examMessage').className = "message warning";
                return;
            }
            
            let score = 0;
            const mistakes = [];
            
            for (let i = 1; i <= totalQuestions; i++) {
                const userAnswer = userAnswers[i];
                const correctAnswer = correctAnswers[i];
                
                if (userAnswer === correctAnswer) {
                    score++;
                } else {
                    let userAnswerText = userAnswer;
                    let correctAnswerText = correctAnswer;
                    
                    if (typeof userAnswer === 'boolean') {
                        userAnswerText = userAnswer ? 'âœ“' : 'âœ—';
                    }
                    
                    if (typeof correctAnswer === 'boolean') {
                        correctAnswerText = correctAnswer ? 'âœ“' : 'âœ—';
                    }
                    
                    mistakes.push({
                        question: i,
                        userAnswer: userAnswerText,
                        correctAnswer: correctAnswerText
                    });
                }
            }
            
            const percentage = Math.round((score / totalQuestions) * 100);
            showResults(score, totalQuestions, percentage, mistakes);
            
            const examKey = getExamStorageKey(studentCode);
            const examRecord = JSON.parse(localStorage.getItem(examKey) || "{}");
            examRecord.completed = true;
            examRecord.score = score;
            examRecord.totalQuestions = totalQuestions;
            examRecord.percentage = percentage;
            examRecord.completedAt = new Date().toISOString();
            localStorage.setItem(examKey, JSON.stringify(examRecord));
            
            sessionStorage.removeItem('current_exam_code');
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
        function showResults(score, totalQuestions, percentage, mistakes) {
            document.getElementById('codeEntry').style.display = 'none';
            document.getElementById('examContainer').style.display = 'none';
            document.getElementById('resultsContainer').style.display = 'block';
            
            document.getElementById('finalScore').textContent = `Ø§Ù„Ø¯Ø±Ø¬Ø©: ${score}/${totalQuestions} (${percentage}%)`;
            
            const mistakesList = document.getElementById('mistakesList');
            mistakesList.innerHTML = "";
            
            if (mistakes.length === 0) {
                mistakesList.innerHTML = '<div class="message success">Ù…Ù…ØªØ§Ø²! Ù„Ù… ØªØ±ØªÙƒØ¨ Ø£ÙŠ Ø£Ø®Ø·Ø§Ø¡.</div>';
            } else {
                mistakesList.innerHTML = '<h3>Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ØªÙŠ ÙˆÙ‚Ø¹Øª ÙÙŠÙ‡Ø§:</h3>';
                
                mistakes.forEach(mistake => {
                    const mistakeItem = document.createElement('div');
                    mistakeItem.className = 'mistake-item';
                    
                    let questionText = "";
                    let questionNumber = mistake.question;
                    
                    // Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù…Ù† 1-5 Ù‡ÙŠ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ØŒ Ù…Ù† 6-10 Ù‡ÙŠ ØµØ­/Ø®Ø·Ø£
                    if (mistake.question <= 5) {
                        const questionElement = document.querySelector(`.question:nth-child(${mistake.question + 1}) .question-text`);
                        questionText = questionElement ? questionElement.textContent : `Ø§Ù„Ø³Ø¤Ø§Ù„ ${mistake.question}`;
                    } else {
                        const questionElement = document.querySelector(`.question:nth-child(${mistake.question + 2}) .question-text`);
                        questionText = questionElement ? questionElement.textContent : `Ø§Ù„Ø³Ø¤Ø§Ù„ ${mistake.question}`;
                    }
                    
                    mistakeItem.innerHTML = `
                        <p><strong>Ø§Ù„Ø³Ø¤Ø§Ù„ ${mistake.question}:</strong> ${questionText}</p>
                        <p>Ø¥Ø¬Ø§Ø¨ØªÙƒ: <span class="user-answer">${mistake.userAnswer}</span></p>
                        <p>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: <span class="correct-answer">${mistake.correctAnswer}</span></p>
                    `;
                    
                    mistakesList.appendChild(mistakeItem);
                });
            }
        }
        
        // Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯
        function backToCodeEntry() {
            document.getElementById('codeEntry').style.display = 'block';
            document.getElementById('examContainer').style.display = 'none';
            document.getElementById('resultsContainer').style.display = 'none';
            
            document.getElementById('studentCode').value = "";
            document.getElementById('studentCode').focus();
            
            document.getElementById('codeMessage').textContent = "";
            document.getElementById('codeMessage').className = "message";
        }
    </script>
</body>
</html>
